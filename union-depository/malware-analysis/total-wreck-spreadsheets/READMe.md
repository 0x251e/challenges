The cybersecurity team has been notified of unusual network activity originating from the HR department. An Excel file titled "Employee_Salaries_2024.xlsx" has been shared internally, supposedly containing sensitive payroll information for the upcoming year. Some employees who accessed the file reported unexpected system issues soon afterward, prompting an investigation into whether the document may be linked to these incidents. As an malware analyst, your role is to analyze the Excel file and investigate its contents. There may be hidden elements within the file contributing to the unusual behavior on the network.

### Challenge Details:
- File: Employee_Salaries_2024.xlsx
- **Tools Required:** Use `odedump` to inspect and analyze any embedded code within the file.
- **Goals:**
	1. Extract and review hidden content within the Excel file.
	2. Determine the purpose of any embedded elements and evaluate their potential impact.
	3. Provide insights into how these elements might interact with the internal network.

Checklist for Challenge Environment:
- [x] Windows 10 VM
- [x] Disable Windows Defender (All OFF)
- [x] Disable Windows Firewall (All OFF)
- [x] Disable Controlled Folder Access 
- [x] Disable Exploit Protection (**Windows Security** → **App & browser control** → **Exploit protection settings**.)
- [x] Disable SmartScreen
- [x] Disable Application Guard
- [x] Disable UAC (**Windows Security** → **App & browser control** → **Exploit protection settings**.)
	- `HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System`
	- EnableLUA to 0
	- Restart
- [x] Disable Windows Defender via Registry
	- - `HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender`
	- Create a new **DWORD (32-bit) Value** named **DisableAntiSpyware** and set its value to `1`.
- [x] Disable Windows Defender Services
	- Open **Services.msc**, locate **Windows Defender Antivirus Service**, and set it to **Disabled**.
- [ ] Disable Windows Update
	- Go to **Services.msc**, find **Windows Update**, and set it to **Disabled** to prevent updates from re-enabling security controls.
- [x] Windows Registry: Enable Macros in Excel
	- Open **Registry Editor** (`regedit`) and navigate to:
    `HKEY_CURRENT_USER\Software\Microsoft\Office\<Version>\Excel\Security`
	- Create or modify a **DWORD** value called **VBAWarnings** and set it to `1` (disables macro warnings).
- [ ] Disable Windows Defender Antivirus via Group Policy
	- Open **Local Group Policy Editor** (`gpedit.msc`) and navigate to
	- Computer Configuration → Administrative Templates → Windows Components → Windows Defender Antivirus
	- Enable the policy **Turn off Windows Defender Antivirus**.

Checklist for Challenge Creation:
- [x] Excel File Sample (Contain data)
- [ ] VBA macros (https://github.com/S3cur3Th1sSh1t/OffensiveVBA/blob/main/src/Evasion_Dropper_Autostart.vba)
- [x] Obfuscate macros
- [x] 1st Testing (macros)
- [x] 2nd Testing (odedump)
- [x] Flag placement
- [x] 3rd Testing (flag)

